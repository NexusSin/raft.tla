---- MODULE raft_0240655845_TTrace_1748424042 ----
EXTENDS Sequences, TLCExt, raft_0240655845, Toolbox, Naturals, TLC

_expression ==
    LET raft_0240655845_TEExpression == INSTANCE raft_0240655845_TEExpression
    IN raft_0240655845_TEExpression!expression
----

_trace ==
    LET raft_0240655845_TETrace == INSTANCE raft_0240655845_TETrace
    IN raft_0240655845_TETrace!trace
----

_inv ==
    ~(
        TLCGet("level") = Len(_TETrace)
        /\
        votedFor = ((r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2))
        /\
        log = ((r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<[term |-> 2, value |-> v1, payload |-> v1]>>))
        /\
        voterLog = ((r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>))
        /\
        unorderedRequests = ((r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}))
        /\
        nextIndex = ((r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)))
        /\
        Servers = ({r2, r3, r4})
        /\
        switchIndex = (r1)
        /\
        maxc = (2)
        /\
        switchBuffer = ((v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]))
        /\
        currentTerm = ((r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2))
        /\
        entryCommitStats = ((<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]))
        /\
        votesResponded = ((r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}))
        /\
        votesGranted = ((r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}))
        /\
        messages = (([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r4, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 2] :> 1 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r4, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 0))
        /\
        matchIndex = ((r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)))
        /\
        switchSentRecord = ((r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}))
        /\
        state = ((r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower))
        /\
        leaderCount = ((r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0))
        /\
        commitIndex = ((r1 :> 0 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1))
    )
----

_init ==
    /\ messages = _TETrace[1].messages
    /\ matchIndex = _TETrace[1].matchIndex
    /\ log = _TETrace[1].log
    /\ switchSentRecord = _TETrace[1].switchSentRecord
    /\ state = _TETrace[1].state
    /\ Servers = _TETrace[1].Servers
    /\ leaderCount = _TETrace[1].leaderCount
    /\ entryCommitStats = _TETrace[1].entryCommitStats
    /\ commitIndex = _TETrace[1].commitIndex
    /\ currentTerm = _TETrace[1].currentTerm
    /\ votesResponded = _TETrace[1].votesResponded
    /\ switchIndex = _TETrace[1].switchIndex
    /\ maxc = _TETrace[1].maxc
    /\ nextIndex = _TETrace[1].nextIndex
    /\ votesGranted = _TETrace[1].votesGranted
    /\ switchBuffer = _TETrace[1].switchBuffer
    /\ voterLog = _TETrace[1].voterLog
    /\ votedFor = _TETrace[1].votedFor
    /\ unorderedRequests = _TETrace[1].unorderedRequests
----

_next ==
    /\ \E i,j \in DOMAIN _TETrace:
        /\ \/ /\ j = i + 1
              /\ i = TLCGet("level")
        /\ messages  = _TETrace[i].messages
        /\ messages' = _TETrace[j].messages
        /\ matchIndex  = _TETrace[i].matchIndex
        /\ matchIndex' = _TETrace[j].matchIndex
        /\ log  = _TETrace[i].log
        /\ log' = _TETrace[j].log
        /\ switchSentRecord  = _TETrace[i].switchSentRecord
        /\ switchSentRecord' = _TETrace[j].switchSentRecord
        /\ state  = _TETrace[i].state
        /\ state' = _TETrace[j].state
        /\ Servers  = _TETrace[i].Servers
        /\ Servers' = _TETrace[j].Servers
        /\ leaderCount  = _TETrace[i].leaderCount
        /\ leaderCount' = _TETrace[j].leaderCount
        /\ entryCommitStats  = _TETrace[i].entryCommitStats
        /\ entryCommitStats' = _TETrace[j].entryCommitStats
        /\ commitIndex  = _TETrace[i].commitIndex
        /\ commitIndex' = _TETrace[j].commitIndex
        /\ currentTerm  = _TETrace[i].currentTerm
        /\ currentTerm' = _TETrace[j].currentTerm
        /\ votesResponded  = _TETrace[i].votesResponded
        /\ votesResponded' = _TETrace[j].votesResponded
        /\ switchIndex  = _TETrace[i].switchIndex
        /\ switchIndex' = _TETrace[j].switchIndex
        /\ maxc  = _TETrace[i].maxc
        /\ maxc' = _TETrace[j].maxc
        /\ nextIndex  = _TETrace[i].nextIndex
        /\ nextIndex' = _TETrace[j].nextIndex
        /\ votesGranted  = _TETrace[i].votesGranted
        /\ votesGranted' = _TETrace[j].votesGranted
        /\ switchBuffer  = _TETrace[i].switchBuffer
        /\ switchBuffer' = _TETrace[j].switchBuffer
        /\ voterLog  = _TETrace[i].voterLog
        /\ voterLog' = _TETrace[j].voterLog
        /\ votedFor  = _TETrace[i].votedFor
        /\ votedFor' = _TETrace[j].votedFor
        /\ unorderedRequests  = _TETrace[i].unorderedRequests
        /\ unorderedRequests' = _TETrace[j].unorderedRequests

\* Uncomment the ASSUME below to write the states of the error trace
\* to the given file in Json format. Note that you can pass any tuple
\* to `JsonSerialize`. For example, a sub-sequence of _TETrace.
    \* ASSUME
    \*     LET J == INSTANCE Json
    \*         IN J!JsonSerialize("raft_0240655845_TTrace_1748424042.json", _TETrace)

=============================================================================

 Note that you can extract this module `raft_0240655845_TEExpression`
  to a dedicated file to reuse `expression` (the module in the 
  dedicated `raft_0240655845_TEExpression.tla` file takes precedence 
  over the module `raft_0240655845_TEExpression` below).

---- MODULE raft_0240655845_TEExpression ----
EXTENDS Sequences, TLCExt, raft_0240655845, Toolbox, Naturals, TLC

expression == 
    [
        \* To hide variables of the `raft_0240655845` spec from the error trace,
        \* remove the variables below.  The trace will be written in the order
        \* of the fields of this record.
        messages |-> messages
        ,matchIndex |-> matchIndex
        ,log |-> log
        ,switchSentRecord |-> switchSentRecord
        ,state |-> state
        ,Servers |-> Servers
        ,leaderCount |-> leaderCount
        ,entryCommitStats |-> entryCommitStats
        ,commitIndex |-> commitIndex
        ,currentTerm |-> currentTerm
        ,votesResponded |-> votesResponded
        ,switchIndex |-> switchIndex
        ,maxc |-> maxc
        ,nextIndex |-> nextIndex
        ,votesGranted |-> votesGranted
        ,switchBuffer |-> switchBuffer
        ,voterLog |-> voterLog
        ,votedFor |-> votedFor
        ,unorderedRequests |-> unorderedRequests
        
        \* Put additional constant-, state-, and action-level expressions here:
        \* ,_stateNumber |-> _TEPosition
        \* ,_messagesUnchanged |-> messages = messages'
        
        \* Format the `messages` variable as Json value.
        \* ,_messagesJson |->
        \*     LET J == INSTANCE Json
        \*     IN J!ToJson(messages)
        
        \* Lastly, you may build expressions over arbitrary sets of states by
        \* leveraging the _TETrace operator.  For example, this is how to
        \* count the number of times a spec variable changed up to the current
        \* state in the trace.
        \* ,_messagesModCount |->
        \*     LET F[s \in DOMAIN _TETrace] ==
        \*         IF s = 1 THEN 0
        \*         ELSE IF _TETrace[s].messages # _TETrace[s-1].messages
        \*             THEN 1 + F[s-1] ELSE F[s-1]
        \*     IN F[_TEPosition - 1]
    ]

=============================================================================



Parsing and semantic processing can take forever if the trace below is long.
 In this case, it is advised to uncomment the module below to deserialize the
 trace from a generated binary file.

\*
\*---- MODULE raft_0240655845_TETrace ----
\*EXTENDS IOUtils, raft_0240655845, TLC
\*
\*trace == IODeserialize("raft_0240655845_TTrace_1748424042.bin", TRUE)
\*
\*=============================================================================
\*

---- MODULE raft_0240655845_TETrace ----
EXTENDS raft_0240655845, TLC

trace == 
    <<
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 0,switchBuffer |-> <<>>,currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> <<>>,votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 1,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> <<>>,votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> <<>>,votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {v1} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> <<>>,votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {v1, v2} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> <<>>,votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {v2} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> <<>>,matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {v1} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> FALSE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 0, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 1 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {v2} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 2] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r4, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 1 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 2] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {v1}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r4, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 2] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<[term |-> 2, value |-> v1, payload |-> v1]>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r4, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 2] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 1),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 0)]),
    ([votedFor |-> (r1 :> r2 @@ r2 :> Nil @@ r3 :> r2 @@ r4 :> r2),log |-> (r1 :> <<>> @@ r2 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r3 :> <<[term |-> 2, value |-> v1, payload |-> v1], [term |-> 2, value |-> v2, payload |-> v2]>> @@ r4 :> <<[term |-> 2, value |-> v1, payload |-> v1]>>),voterLog |-> (r1 :> <<>> @@ r2 :> (r3 :> <<>> @@ r4 :> <<>>) @@ r3 :> <<>> @@ r4 :> <<>>),unorderedRequests |-> (r1 :> {} @@ r2 :> {} @@ r3 :> {} @@ r4 :> {}),nextIndex |-> (r1 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r2 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 2 @@ r4 :> 1) @@ r3 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1) @@ r4 :> (r1 :> 1 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)),Servers |-> {r2, r3, r4},switchIndex |-> r1,maxc |-> 2,switchBuffer |-> (v1 :> [term |-> 2, value |-> v1, payload |-> v1] @@ v2 :> [term |-> 2, value |-> v2, payload |-> v2]),currentTerm |-> (r1 :> 2 @@ r2 :> 2 @@ r3 :> 2 @@ r4 :> 2),entryCommitStats |-> (<<1, 2>> :> [sentCount |-> 1, ackCount |-> 1, committed |-> TRUE] @@ <<2, 2>> :> [sentCount |-> 1, ackCount |-> 0, committed |-> FALSE]),votesResponded |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),votesGranted |-> (r1 :> {} @@ r2 :> {r3, r4} @@ r3 :> {} @@ r4 :> {}),messages |-> ([mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r3, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v2]>>] :> 0 @@ [mtype |-> RecoveryRequest, mterm |-> 2, msource |-> r4, mdest |-> r2, mentries |-> <<[term |-> 2, value |-> v1]>>] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r3, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 2] :> 1 @@ [mtype |-> AppendEntriesResponse, mterm |-> 2, msource |-> r4, mdest |-> r2, msuccess |-> TRUE, mmatchIndex |-> 1] :> 1 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 0] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r3, mprevLogIndex |-> 1, mprevLogTerm |-> 2, mentries |-> <<[term |-> 2, value |-> v2]>>, mcommitIndex |-> 1] :> 0 @@ [mtype |-> AppendEntriesRequest, mterm |-> 2, msource |-> r2, mdest |-> r4, mprevLogIndex |-> 0, mprevLogTerm |-> 0, mentries |-> <<[term |-> 2, value |-> v1]>>, mcommitIndex |-> 1] :> 0),matchIndex |-> (r1 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r2 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 1 @@ r4 :> 0) @@ r3 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0) @@ r4 :> (r1 :> 0 @@ r2 :> 0 @@ r3 :> 0 @@ r4 :> 0)),switchSentRecord |-> (r1 :> {} @@ r2 :> {<<v1, 2>>, <<v2, 2>>} @@ r3 :> {} @@ r4 :> {}),state |-> (r1 :> Switch @@ r2 :> Leader @@ r3 :> Follower @@ r4 :> Follower),leaderCount |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 0 @@ r4 :> 0),commitIndex |-> (r1 :> 0 @@ r2 :> 1 @@ r3 :> 1 @@ r4 :> 1)])
    >>
----


=============================================================================

---- CONFIG raft_0240655845_TTrace_1748424042 ----
CONSTANTS
    v1 = v1
    v2 = v2
    r1 = r1
    r2 = r2
    r3 = r3
    r4 = r4
    AppendEntriesResponse = AppendEntriesResponse
    Follower = Follower
    Leader = Leader
    RecoveryRequest = RecoveryRequest
    Nil = Nil
    RequestVoteResponse = RequestVoteResponse
    Candidate = Candidate
    Switch = Switch
    RequestVoteRequest = RequestVoteRequest
    AppendEntriesRequest = AppendEntriesRequest
    Value <- const_174842341360368000
    Server <- const_174842341360369000
    MaxTerm <- const_174842341360370000
    MaxBecomeLeader <- const_174842341360371000
    MaxClientRequests <- const_174842341360372000
    v1 = v1
    Follower = Follower
    AppendEntriesRequest = AppendEntriesRequest
    Leader = Leader
    r1 = r1
    RecoveryRequest = RecoveryRequest
    v2 = v2
    Nil = Nil
    RequestVoteResponse = RequestVoteResponse
    r3 = r3
    Candidate = Candidate
    r2 = r2
    Switch = Switch
    AppendEntriesResponse = AppendEntriesResponse
    RequestVoteRequest = RequestVoteRequest
    r4 = r4

INVARIANT
    _inv

CHECK_DEADLOCK
    \* CHECK_DEADLOCK off because of PROPERTY or INVARIANT above.
    FALSE

INIT
    _init

NEXT
    _next

CONSTANT
    _TETrace <- _trace

ALIAS
    _expression
=============================================================================
\* Generated on Wed May 28 11:20:54 CEST 2025